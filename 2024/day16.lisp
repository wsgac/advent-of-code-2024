(in-package #:advent-of-code-2024.day16)

(defun parse-input (input)
  (let ((arr (util:parse-string-into-array input))
        start
        end)
    (util:array-loop (arr (r c) :item el)
                     (when (char= #\S el)
                       (setf start `(,r ,c))
                       (setf (aref arr r c) #\.))
                     (when (char= #\E el)
                       (setf end `(,r ,c))
                       (setf (aref arr r c) #\.)))
    (values arr start end)))

(defun problem-1 (&key (input *input-part-1-test*))
  (multiple-value-bind (arr start end)
      (parse-input input)
    (let* ((pq (make-instance 'util:priority-queue
                              :cmp #'< :key #'first
                              :list (list (list 0 start '(0 1) (list start)))))
           (seen (make-hash-table :test #'equal))
           (best nil)
           (lowest most-positive-fixnum))
      (loop
        while (not (pq-empty? pq))
        for (score location delta trail) = (pq-pop pq)
        when (> score lowest)
          do (return)
        when (equal location end)
          do (progn
               (when (< score lowest)
                 (setf best nil))
               (setf lowest score)
               (setf best (union trail best :test #'equal)))
        do (setf (gethash (list location delta) seen) score)
        do (loop
             for dir in '((0 -1) (0 1) (1 0) (-1 0))
             if (char/= #\# (apply #'aref arr (util:vec+ location dir)))
               do (let ((cost (if (equal dir delta) 1 1001)))
                    (when (< (+ score cost)
                             (gethash (list (util:vec+ location dir) dir) seen most-positive-fixnum))
                      (pq-push pq (list (+ score cost)
                                        (util:vec+ location dir)
                                        dir
                                        (append trail (list (util:vec+ location dir)))))))))
      (values lowest
              (length best)))))

(defparameter *input-part-1-test*
  "###############
#.......#....E#
#.#.###.#.###.#
#.....#.#...#.#
#.###.#####.#.#
#.#.#.......#.#
#.#.#####.###.#
#...........#.#
###.#.#####.#.#
#...#.....#.#.#
#.#.#.###.#.#.#
#.....#...#.#.#
#.###.#.#.#.#.#
#S..#.....#...#
###############")

(defparameter *input-part-2-test*
  "#################
#...#...#...#..E#
#.#.#.#.#.#.#.#.#
#.#.#.#...#...#.#
#.#.#.#.###.#.#.#
#...#.#.#.....#.#
#.#.#.#.#.#####.#
#.#...#.#.#.....#
#.#.#####.#.###.#
#.#.#.......#...#
#.#.###.#####.###
#.#.#...#.....#.#
#.#.#.#####.###.#
#.#.#.........#.#
#.#.#.#########.#
#S#.............#
#################")

(defparameter *input*
  "#############################################################################################################################################
#.....#.......#.............#.........#.......................#.......#...#...............#.....#.#.................................#.#....E#
#.#####.###.###.#######.###.#.#.#######.#.###.#####.###.#######.#.###.###.#.#####.#####.###.#.#.#.#.#####.###.#.###.#######.###.#.#.#.#.#.#.#
#.......#...#...#.....#.#.#.#.#.#...#...#.....#...#.#...#.......#...#.#...#...#...#.#...#...............#...#...#.#.......#.#...#.#.#...#.#.#
#########.#.#.###.#####.#.#.#.#.#.#.#.#########.#.#.###.#.#########.#.#.#.#.###.#.#.#.###.###.#####.###.###.#.#.#.###.###.#.#.###.#.#.###.#.#
#.......#.#.#.#...#...#.#.#.#.#...#.....#.......#.#...#.#.#...#...#.#...#.#.#...#.....#...#.#...#...#.....#.#.....#.....#.#...#...#.#.#...#.#
#.#####.#.###.#.#.#.#.#.#.#.###########.#######.#.###.#.#.###.#.#.#.#.#####.#.###.###.#.###.###.#.###.#.###.#.#.#.#.#.#.#.#.#.#.###.###.#####
#...#...#.......#.#.#...#.#...........................#.#.#...#.#...#.#.....#.#.....#.#...#...#.....................#.#.#...................#
#.#.#.#######.#####.#####.###########.#######.#####.#.###.#.###.#######.#####.###.#.#.###.#.#.#.#.#######.###.#.#####.#.#.#.#.###.###.#.###.#
#.#...#.....#.#...#...#.......#.......#.....#...#...#.....#.#...#.....#...#...#.....#...#...#.#...#.......#...#.#...#.#.#.#.#...#.#...#...#.#
#.#.###.###.###.#.#.#.###.###.#.#.#####.###.###.#.#########.#.###.###.###.#.###.#.###.#######.#####.#######.#.#.#.#.#.###.###.#.#.#.#######.#
#.#.....#.......#.#.#...#.#...#.#...#...#.#.#.#.#.......#...#...#...#.......................#...#.#.#.....#.#.....#.#.........#...#.#.....#.#
#.###.###########.#####.#.#####.#.#.#.#.#.#.#.#.###.###.#.#.###.###.#########.###.#.#.#.###.#.#.#.#.#####.#.#.#.#####.#######.#####.#.###.#.#
#...#...................#.....#.#.#.#.#.#.....#.....#.#...#.#.#...#.....#...#.....#.#.#.#.#.....#.#.....#.#...#.#.........#...........#.....#
#.#.#.#.###.#.###############.#.#.#.#.#.#############.#####.#.###.#####.#.#.#####.#.#.#.#.#######.#####.#.###.#.#.###.###.#.#.###.###########
#.#.#.#.#.#.#.#.....#.......#.#...#...#...............#...#...#.#...#...#.#.......#.#.#.#.......#...#...#.....#.#.#.......#.#...#.#.........#
#.#.###.#.#.###.###.###.#.#.#.###.#.#####.###.###.###.#.#.###.#.#.###.###.###.###.#.#.#.###.###.###.#.###.#####.#.#.#.###.#.#.#.###.#######.#
#.#.....#.#...#.#.#...#.#.#.#...#.#.#...#...#...#...#...#...#...#.....#...#...#.......#.....#.#.....#...#.......#...#.#...#...#...#.#.#.....#
#.#######.###.#.#.###.#.#.#.#.#.#.###.#.#####.#.#.#.#########.#.#######.#.#.#.#.#############.#####.###.#########.#####.###.#####.#.#.#.#.###
#.#.......#.#.....#...#.#.#...#.#.#...#.....#.#.#.#.........#.#.........#.#.#.#.#.................#.#.#...#.......#.........#...#...#.#.....#
#.#.#####.#.#######.#####.#######.#.#####.#.###.#.#########.#.#.#########.#.#.#.###.#######.#.#####.#.###.#.#######.#.###.###.#.#####.###.#.#
#.#.....#.......#...#...#...#.....#.#...........#.#.......#...#.#...#.....#.#.#...#.#.......#.#...#...#...#.....#...#...#.#.................#
#.#####.#######.#.###.#.###.#.#####.#######.#####.#.#.###.#####.#.#.###.###.#.###.###.#####.###.#.###.#.#######.#.#####.#.#####.#.#.###.#.#.#
#.#...#.#.....#...#...#...#.#.......#.....#.#.....#.#...#.#...#.#.#...#.#...#.#.#...#.#...#.#...#...#.#.........#.....#.#.......#...#...#.#.#
#.#.#.#.#.###.#.###.#####.#.#.#####.#.###.###.#########.###.#.#.#.###.#.#.###.#.###.#.#.#.###.###.###.###############.#.###########.#.###.#.#
#.#.#.#.#.#.....#...#...#...#.....#...#.#...#.#...#...#.#...#.#...#...#.#.#.#.#.........#.#...#.#.....#.......#.......#.........#...#.#.....#
#.#.#.#.#.#######.###.#.#.#.#####.###.#.###.#.#.#.#.#.#.#.###.#####.#####.#.#.#########.#.#.###.#######.#######.###############.#.###.#.#.###
#.#.#...#.........#...#.#.#.....#...#...#.#.....#...#...#.#.#...#...#.....#.#.....#.....#...#.....#.....#.....#...#...#...#.....#...#.#.#...#
#.#.#########.#######.#.#.#.###.###.###.#.###########.###.#.###.#.###.#.###.#####.#.#########.#.#.###.#.#.###.#.#.#.#.#.#.#.#######.#.#.#.#.#
#...#...#...#.......#.#.#.#.#.....#.......#...#.....#.#...#...#.#...#...#.......#...#.....#...#.#.....#.#...#...#...#...#...#...............#
###.#.#.#.#.#######.#.#.#.#.#.#######.#####.#.#.###.###.###.###.#.#.###.#.#.#.#.#####.#.###.###.###.#######.#####.###########.#.###.#.#######
#...#.#...#...#...#...#.#.#.#.......#.....#.#.....#.....#...#...#.#...#...#.#...#.....#...#...#.#.........#.....#.........#...#.....#...#...#
#.#.#.#######.###.#####.#.#.#######.#####.#.#####.#######.#.#.#######.#.###.#.###.#.###.#.###.#.#.#######.#####.#.#######.#.#####.#####.#.#.#
#.#...#.....#...#.....#...#...#...#.....#...#...#.#...#...#...........#.....#.#...#...#.#.....#...#.#...#.#...#...#.....#.#.#.....#...#...#.#
#.#.###.###.###.#.###.#.#.###.#.###.#########.#.#.#.#.#.#####.#.#########.#.#.###.###.###########.#.#.#.#.#.#.###.###.#.#.#.#.###.#.#.#####.#
#.#.#...#.#...#.....#...#.#.#...#...#.........#.#...#.#...#...#.....#...#...#...#...#...........#...#.#.#...#...#...#.#...#.......#.#.......#
#.#.#.###.###.#####.#.###.#.###.#.###.#####.###.###.#.###.#.#.###.#.#.#.#######.#.#.###########.#####.#.#####.#.###.#.###########.#.#########
#.#.#.#.....#.#...#.#...#.#.#...#.....#...#.#...#.....#...#.#.....#...#...#...#.#.#.....#...#...#.....#.........#...#.......#.....#.........#
#.#.#.#####.#.###.#.#####.#.#.#########.###.#.#.#.###.#.###.###########.#.#.###.#.#####.#.#.#.###.#########.#####.#########.#####.#########.#
#.#.#.#.....#...#.#.....#.............#...#.#...#.#...#...#.......#.#...#.#.#...#.....#.#...#.#...#.........#.....#.............#...#.......#
###.#.#.#######.#.#####.#.#.#####.###.###.#.#.###.#.#####.#######.#.#.###.#.#.#########.###.#.#.###.#####.#.#.#####.#.#########.#.###.#.###.#
#...#.#.......#...#.....#.#.#.......#.....#.#.....#.#.......#.......#.#.#...#.........#...#.#.#.....#.....#.#...#...#.........#.#.#...#...#.#
#.#.#.#.#####.###.#.#####.###.###.#.###.###.#######.#.#####.#.#####.#.#.###.#########.###.#.#.#.#####.#####.###.#####.#######.#.#.#.###.#.#.#
#.#...#.....#...#.#.#.........#...#.#...#...#.....#.#.#.....#...#...#.#.....#.......#.....#.#.#.....#...#...#.#.....#.#.#.........#.#.....#.#
#.#.#.###.#####.#.#.###.#######.###.#.###.#.#.###.###.###.#####.#.###.#.#####.###.#.#######.#.#####.#.#.#.###.#####.#.#.#.#####.#.#.#.#.#.#.#
#.#.#.#...#...#...#...........#.#.....#...#.#...#.....#...#.....#...#.#.....#.#.#.#.#.......#.......#.#.#...#...#...#...#...#...#...#...#.#.#
#.###.###.#.#.#.#.###.#######.#.#######.###.###.#######.###.#######.#.#####.#.#.#.###.###.#############.###.#.#.#.#####.###.#.###.###.#.###.#
#...#...#.#.#...#.....#...#.....#.......#.....#...#.....#...#.....#.#...#...#...#.......#...#...........#.#...#.#.....#...#.#...#.#...#.....#
#.#.#.#.###.###.#.#####.#.#######.###############.###.#.#.###.#.#.#.###.#.#####.###.###.###.#.#######.#.#.#####.#####.#.###.###.#.#####.###.#
#.#.#.#.....#...#.#.....#...#...#.#.............#.....#.#...#.#.#.....#.#.#...#...#.......#...#.......#.....#...#...#...#...#...#...........#
###.#########.#.#.#.#######.#.#.#.#.#########.#########.###.###.###.###.###.#.###.###.#.#######.###########.#.###.#.#####.###.###.#.#.#.#.###
#...#.....#...#.#.........#...#.#...#...#.#...#...........#...#.......#.....#...#...#.#...#.......#.....#...#...#.#.....#.#.#.#.....#...#...#
#.###.###.#.#####.#######.#####.#.###.#.#.#.###.#############.#####.#.#########.###.#####.#.#.###.#####.#.#####.#.#######.#.#.#########.###.#
#.#...#.....#.....#...#...#...#.#.#...#...#.....#.............#...#.#...#.....#...#...#...#.....#.....#.......#.#.#.......#.#.#...........#.#
#.#.#######.#.#####.#.#.###.#.#.#.#.#.###########.#############.#.###.#.#.###.###.###.#.#.#.###.#####.#########.#.#.#######.#.#.#######.#.#.#
#.........#.#...#.#.#.#.#.#.#...#...#.............#.....#.......#.#...#.#.#.#...#.....#.#.#...#.......#.......#...#.#.......#.#.......#.#...#
#.#######.#.###.#.#.#.#.#.#.###.#####.#############.#.###.#.#####.#.###.#.#.###.#######.#####.#######.#.###.#.#.###.#.#####.#.#.#####.#.#.###
#...#.....#.#...#.#.#...#.#...#.#...#.#.......#.....#.....#...#...#.#...#.#...#.#...............#.....#...#.#...#...#.....#.#.#...#...#.....#
#.#.#.#######.###.#.#####.###.###.#.#.#.#.#.#.#.#############.#.###.#.###.###.#.#.#####.#.#.#.#.###.#####.#.#####.###.###.###.###.#.###.#.###
#.#.#.......#...#.#.#.......#.#...#...#...#.#.#...#.....#.....#.#...#...#...#.....#.#...#.#.#.#.......#...#.#.....#.#.#...#...#...#.#.......#
###.#.#####.###.#.#.#.#.#####.#.#########.#.#.###.#.#.###.#####.#.#####.###.#.#####.#.###.#.#####.#.#.#.###.#.#####.#.#.#.#.#######.#.#.#.#.#
#...#.....#...#...#.#.#...#...#.#.......#.#.#...#.....#...#...#.#...#.#.....#.#...#.....#.#.#.....#...#.....#...#...#.#.#.#.#.......#...#.#.#
#.#.#########.###.#.#.###.#.#.#.#.###.###.#.###.#####.#.#####.#.#.#.#.###.#####.#.#######.#.#.#####.#######.###.###.#.#.#.#.#.#########.#.#.#
#.#.........#...#.#.#...#.#.....#...#.....#...#.....#.#.#.....#.#.#.#.....#.....#...#.....#...#...#.#.......#.......#.#.....#.....#.......#.#
#.#.#######.###.#.#.#####.#######.#.#########.#####.###.###.###.#.#.###.###.#######.#.#.#######.#.#.#.#.#.###.###.###.#######.###.###.#.#.#.#
#.#...#...#...#...#.......#.......#.....#.........#...#...#...#.#.#...#.#.#...#...#...#.......#.#.#...#.#.#.#.#.....#.#.......#.............#
#.###.#.#.###.###########.#.###########.#.#.#####.###.#.#.#.#.#.#.###.#.#.###.#.#.#.###.#.###.###.#.###.#.#.#.#####.#.###.#####.###.#.#.#####
#...#...#.#.#.#...#.....#.#...#...........#.......#...#.#.#.#...#...#.#...#...#.#...#.....#.....#.......#...#...........#.#.......#.#...#...#
#.#.#####.#.#.#.#.#.###.#.###.#####.#######.#.#####.###.#.###.#####.#.#####.#########.#####.###.#######.###.###.#.#.###.#.#.#####.#.#.###.#.#
#.#.#.......#.#.#...#...#...#...#...#.....#.#.......#...#...#...#...#.#...#...#...#...#.......#...#.....#...#...#.#...#.#...#...#.#.#.....#.#
#.#.#.#######.#.#####.#####.###.#.#.#.###.#.#############.#.###.#.###.#.#.#.#.#.#.#.#####.###.###.#######.###.###.#####.#####.#.#.#.#.#####.#
#.#.#.#.#.....#.#...#.....#...#.#...#...#.#...#...........#.#...#...#.#.#.#.#...#...#...#.#.#...#...........#...#...#...#.....#.#.#.#.#...#.#
#.#.#.#.#.#####.#.#.#####.###.#.#.#.###.#.###.#.#.#####.###.#.#######.###.#.#####.#.#.#.#.#.###.###########.###.###.#.###.#####.#.#.#.###.#.#
#.#.....#...#...#.#...#...#...#.#.#...#.#.....#...#...#.#...#.........#...#.#.#...#...#.#.#.......#.......#...#...#.#.#.#.#...#...#.#.....#.#
###########.#.###.#.###.#.#.###.#.###.#.#######.#.###.#.#.###.#########.#.#.#.#.#######.#.#.#.#####.#####.###.###.#.#.#.#.#.#.#####.#######.#
#.........#.......#.#...#.#.....#...#.#...#...#.#.#...#.#.#...#.......#.#...#.#.#.........#.....#...#.....#.....#.#...#...#.#.#.....#.......#
#.#######.###########.#.#.#######.###.###.#.#.###.#.###.#.###.#.#####.#.###.#.#.#.#########.#.###.###.#########.#.###.#####.#.#.#####.#.#####
#.................#...#.#...#.....#...#...#.#.....#.#...#...#.#.#.....#...#...#...#...#.#.....#...#...#.......#.#...#.......#...#.#...#.#...#
#.#.#.#.###.###.#.#.###.#.###.#####.#.#.###.#######.#.#####.###.#.###.###.###.#####.#.#.#.#####.###.#.#.#.###.###.#.#############.#.#.###.#.#
#...#.#...#...#.#...#...............#.#.#.....#.....#.....#.#...#...#.#.#.#...#...#.#.#...#.....#.....#.#.#.#...#.#.#.....#.......#.#.....#.#
#.###.###.###.#.#.#.###.###.#####.#.#.#.###.#.#.#.#.#####.#.#.#####.#.#.#.#####.#.#.#.#####.#####.#######.#.###.###.#.#####.###.#.#.###.#.#.#
#...#.#.#.#...#...#...#...#.#.....#.#.#...#.#.#.#.#.....#.#...#...#.#...#.......#...#...#...#...#.#.......#...#...#.#.#...#...#.#.#.#...#.#.#
###.#.#.#.#.#.#####.#.#.###.#.###.#.#####.###.###.#######.#.###.#.#.###############.###.#.###.###.#####.###.#####.#.#.#.#.#.#.#.###.#.#.#.#.#
#...#.#.#...#.....#.#.#.#...#.#...#.....#.....#...#.......#.#...#...#.........#.......#...#.......#.....#.........#.#...#...#.#.....#.#...#.#
#.###.#.###.###.#.#.#.###.###.#######.#########.#.#.#######.#.#######.#######.#.###.#######.#######.#####.#########.#.#####.#.#######.#.###.#
#.#...#.....#...#...#.#...#.#.......#...........#.#.#.......#.#.......#...#...#...#.....#.#...#.#.....#...#.........#.......#.#.......#.#...#
###.#.#######.#######.#.###.#.#####.#.###.#.#####.#.#######.#.#.#####.###.#.#####.###.#.#.###.#.#.###.#.#######.#.###.#.###.#.#.#######.#.###
#...#.#.....#...#...#...#...#.#.#.....#.#.#.#...#.#...#...#.#.#.#.......#.#.....#...#.#.....#.#...#...#.......#.#.#...#.#...#...#.....#.#...#
#.#.###.###.###.#.#.#####.#.#.#.#.###.#.#.###.#.#####.#.#.#.#.#.#.#####.#.#####.###.#.#.#####.#.###.#########.###.#.###.#########.#####.###.#
#.#.#...#.....#.#.#.#...#.#.#...#.#.....#.....#.....#...#.#.#.#...#.#...#...#...#...#.#.#.....#.#...#...#.......#.#...#...........#.....#...#
#.###.###.###.#.#.#.#.#.###.###.#.#########.#####.#####.#.#.#.#####.#.#####.#.#.#.###.###.#######.###.###.#.###.#.#########.#######.#####.###
#.......#...#.#...#...#.#.....#.#.........#.....#.......#.#.#.......#.#.....#.#.#...#...#.#.......#...#...#...#.#.#...#.....#...........#...#
#.#####.###.###########.#.#####.#####.#.#.#.#.#.###.#####.###.#.###.#.#.#####.#####.###.#.#.#.#####.#.#.#.#.###.#.#.#.#.#####.#########.#.#.#
#.#...#...#.......#.....#...#.......#...#...#.#...#.#.........#.......#.....#.......#.#.....#.#.....#.....#.#...#.....#.#.......#.....#.#...#
###.#.###.#.###.###.#######.#.#############.#.#####.#.###############.#.###.#########.#.###.#.#############.#.#######.#.#.###.###.###.###.#.#
#...#...#.#.#...#...#.....#.#.#...........#.#.....#...#.#...#.......#.#...#.............#...#.......#.....#.#.........#.#...#.....#.....#.#.#
#.#####.#.#.#.###.###.###.#.#.#.#########.###.###.#####.#.#.#.#####.#.###.#######.#######.#########.#.###.#.###########.###.#.#.#######.#.#.#
#.....#.#.#.#...#.#.#...#.#...#.....#...#...#.#.........#.#...#...#.#.#.#.....................#.....#...#...#.....#.........#.#.#...#.....#.#
#.###.#.#.#.###.#.#.#.#.#.#########.#.#.###.###.#####.###.#####.#.#.#.#.#.#####.#############.#.###.#.#.###.#.#####.#########.###.#.#####.#.#
#.#...#.#...#...#.#...#.#...........#.#.........#.....#...#.....#.#.#.#.......#.#.......#...#...#.....#...#.#.#.........#...#.#...#...#...#.#
#.#.###.###.#.###.#.###.#############.###########.#.###.#####.###.#.#.#####.#.#.#.###.###.#.#.###.#####.#.#.#.#.#######.#.#.#.#.#####.###.#.#
#.#...#.......#...#...#.#.......#.....#.....#.....#.....#.....#...#...#...#.#.#.#.#...#...#.#.#...#...#.#...#...#...#...#.#.#.#.....#...#...#
#.###.#####.#.#.#######.#######.#.#####.###.#.#############.###.#######.#.###.#.#.###.#.###.#.#.###.#.#.#.#######.#.#.#####.#.#.#######.#.###
#...#...#...#.#.#.......#.......#...#.....#.#...#.........#.#...#.......#...#.....#.....#.#...#.#...#...#.......#.#.#.......#...#.......#...#
#######.###.#.#.###.#####.#####.###.#####.#####.#####.###.#.###.###.#.#####.#######.#####.#######.#############.#.#.#####.#.#####.#######.#.#
#.......#...#.#...#...........#.#...#.....#.....#...#.#...#...#...#.#...#...........#.....#.....#.#.....#.....#.#.#.#.......#.....#.....#...#
#.#######.#.#.###.#.#.#######.###.###.#####.#.###.#.#.#.#####.###.#####.#.###.#########.#.###.#.#.#.#####.#.###.#.#.#########.#####.###.#.###
#.....#.#.......#...#...#...#.....#...#.....#.....#...#.....#...#.......#.....#.........#.....#...#.......#...#.#.#.........#...#.....#.#.#.#
#.###.#.#.#.#########.#.#.#.#######.###.#######.###########.#.#.#################.#################.#########.#.#.#.#######.###.#.###.###.#.#
#.#.#.#.....#.........#.#.#.....#...#...#.............#...#...#.#.#.......#...............#.......#...#.#...#...#.#.#...#.#.#...#...#...#.#.#
#.#.#.###.###.###.#.#.#.#.###.#.#.#.#.#####.#######.#.#.#.###.#.#.#.###.#.#.#.#######.###.#.###.#####.#.#.#.#####.###.#.#.#.#.#######.#.#.#.#
#...#...#.#...#.#...#.#.#...#.....#.#.#.....#.....#.#...#...#.#.#.....#.#.#.#.#.......#.....#.#.....#.#...#.......#.....#...#.#.....#.#.#.#.#
#.#.###.#.#.###.#####.#.###########.#.#.#####.#.#.#.###.#.###.#.#####.#.#.###.#.###.#########.#.#.#.#.#.#######.#.#.###.#.###.#.#.#.###.#.#.#
#.#.....#.#.#.......#.......#.......#...#.....#.#...#.....#...#...#...#.#...#.#...#.#.......#...#.#.......#...#.#.#.#...#.#...#.#.......#...#
#.#.#.#####.#.#.#####.#####.#.#####.###.###.###.#####.#####.#####.#.###.###.#.#####.#.#####.#####.###.###.#.#.#.#.#.#.###.#.###.###########.#
#.#...#...#.#.#...#.......#...#...#.#.....#.#...#.....#...#.....#.#...#.#.#.#.....#.....#...#.....#...#.....#.#.#.#.#...#...#...#...#.....#.#
###.#.#.#.#.#####.#.###.#########.#.###.#.###.#.#######.#.###.#.#.#.###.#.#.#.###.#######.#.#.#####.#.#######.#.#.#.###.#######.#.#.#.###.#.#
#.....#.#...#...#.#...#.#.........#.....#...#.#.#.....#.#.....#...#...#.#.#.#.#.#.......#.#.........#.....#...#.......#.#.....#...#...#...#.#
#.#.###.#####.#.#.###.###.#####.#.#########.#.###.###.#.###.#.#####.#.#.#.#.#.#.#######.#.#.###.###.#####.###.#########.#.###.###.#####.###.#
#.#...#.#.....#...#.#...#...#...#.#.......#.#.#...#...#...#.#.....#.#...#.#.#...#.......#.#...#...#.#...#...#.#.......#...#.#.....#.....#...#
#.#.#.#.#.#######.#.###.###.#.###.###.#.###.#.#.###.###.###.#####.#.#####.#.###.#.#.#.###.###.###.#.#.#####.###.#####.#.###.#####.#.#####.###
#...#...#.....#.#.....#...#.#.#.#...#.#...#.#...#.#.....#...#...#...#.....#.#.....#.#.......#...#...#.....#.....#.....#...#.....#.#.........#
#.#.#####.###.#.#####.###.#.#.#.###.#####.#.#.#.#.#######.#####.#####.#.#.#.#.###.#.#.#####.###.#########.#######.#######.#.###.#.###########
#.#.....#...#.#.#.....#...#.#.#...........#.#...#.#.......#...........#.#.#.#...#...#.....#...#.#.......#...........#...#...#...#...........#
#.#.###.###.#.#.#.#####.###.#.#####.#######.#.###.#.#######.#########.###.#.#.###.#######.###.#.#.#.#.#.###.###.###.#.#######.###.#########.#
#...#...#.#.#.#.#.....#...#.#.#...#.#.....#.#.....#...#.............#.....#.#.....#.....#...#.#.#.#.#.........#.#...#.#.....#.#.....#.....#.#
###.#.###.#.#.#.#.#.#.###.#.#.#.#.#.#.###.#.#####.#.#.#.#####.#.###.###.###.#.#.###.#.#####.#.#.###.#########.#.#.#.#.#.#.#.#.###.#.#.#.###.#
#...#.#.................#.#.#...#.#.#...#.#.#.....#...#.#...#.#...#...#.#...#.#.#...#.....#.#.#...#.....#...#.#.......................#...#.#
#.#.#.#.#####.#.#.#.###.#.#.#.###.###.#.#.#.#.#####.###.###.#.#.#.###.###.#####.#.#.#.###.#.#.###.#####.#.#.#.#.#.#.#####.#.#####.#.#.#.#.#.#
#.#...#.#.....#...#.....#.#.#...#...#...#...#.#...#...#.....#.....#.......................#.#...#.....#.#.#...#.#.#.....#.#.#...#.....#.#.#.#
#.#######.#####.#.#####.#.#.#.#.###.#.#######.#.#.#.#.#########.###.###.#####.###.###.#.###.###.#####.#.#.#####.#.#.###.#.#.#.###.#####.#.#.#
#.......#.#.............#.#...#...#.#.#.#...#...#...#.........#...#.#...#.....#.#.#.#...#...............#.....#.....................#.......#
#######.#.#.#####.#######.###.###.#.#.#.#.#.#####.#.###.#####.#.###.#.#####.###.#.#.#.###.###.#####.#########.#.#####.###.#####.#.#.#.#.#####
#.#...#...#.#.......#.......#.#...#.#.#...#.......................#.#.......#.#...#.#...#...#.....#...#.........#.....#.......#.#...#.......#
#.#.#.#####.#.#.#####.#####.#.#.#.#.#.#####.#.#####.#.###.#.###.#.#.#########.#.###.#.#.###.#.###.###.#########.#.#########.#.#.#.#.###.###.#
#...#.....#.#.#...#...#.....#...#.#.#.#...#...#.....#.#.#...#...#.#.#.........#.......#...#.#...#...#.......#...#.#.......#.#.........#...#.#
#.#######.#.#.###.#.#.#######.###.#.#.#.#.#####.###.#.#.###.#.###.#.#.#######.#######.###.#.#######.#######.#####.#.#####.#######.###.#.#.#.#
#.#.....#...#...#.#.#.#...........#...#.#.........................#.#.....#.#.#.....#.#...#.......#...#.....#...#.....#.#...#.....#.......#.#
#.###.#.#########.#.###.#############.#.#####.###.#.#.#########.###.#####.#.#.#.#.###.#.#########.###.#.#####.#.#.###.#.###.#.###.#####.###.#
#S....#...........#.....................#.........#.............#...........#...#.....#...............#.......#.......#.......#.............#
#############################################################################################################################################")
