(in-package #:aoc2024.day15)

(defun moves-to-deltas (moves)
  (flet ((move-to-delta (move)
           (case move
             (#\^ '(-1 0))
             (#\> '(0 1))
             (#\v '(1 0))
             (#\< '(0 -1)))))
    (loop
      for m across moves
      for d = (move-to-delta m)
      when d
        collect d)))

(defun layout-to-array (layout)
  (let ((arr (util:parse-string-into-array layout))
        robot)
    (util:array-loop (arr (row col) :item el)
      (when (char= el #\@)
        (setf robot `(,row ,col))
        (setf (aref arr row col) #\.))
      ;; (when (char= el #\.)
      ;;   (setf (aref arr row col) nil))
      )
    (list robot arr)))

(defun layout-to-double-array (layout)
  (let* ((rows (u:split-lines layout))
         (arr (make-array (list (length rows)
                                (* 2 (length (first rows))))
                          :initial-element #\.))
         robot)
    (loop
      for r from 0
      for row in rows
      do (loop
           for c from 0
           for ch across row
           do (if (char= #\@ ch)
                  (setf robot `(,r ,(* 2 c)))
                  (progn
                    (setf (aref arr r (* 2 c)) ch)
                    (setf (aref arr r (1+ (* 2 c))) ch)))))
    (list robot arr)))

(defun parse-input (input &key double)
  (destructuring-bind (layout moves)
      (str:split "

" input)
    (cons (moves-to-deltas moves)
          (if double
              (layout-to-double-array layout)
              (layout-to-array layout)))))

(defun calculate-gps (array &key double)
  (let ((gps-sum 0))
    (u:array-loop (array (row col) :item el)
      (when (char= #\O el)
        (incf gps-sum (+ (* 100 row) col))
        (when double
         (setf (aref array row (1+ col)) #\.))))
    gps-sum))

(defun execute (robot array move)
  (loop
    for pos = (u:vec+ robot move) then (u:vec+ pos move)
    until (member (u:aref* array pos) '(#\# #\.) :test #'char=)
    finally (return (if (char= #\# (u:aref* array pos))
                        ;; Found obstacle - no move possible
                        robot
                        ;; Found empty space - enacting
                        (progn
                          ;; Move boxes when empty space not adjacent to robot
                          (unless (equal pos (u:vec+ robot move))
                            (setf (u:aref* arr pos) #\O)
                            (setf (u:aref* arr (u:vec+ robot move)) #\.))
                          ;; Move robot
                          (u:vec+ robot move))))))

(defun problem-1 (&key (input *input-part-1-test-1*))
  (destructuring-bind (moves robot array)
      (parse-input input)
    (loop
      with arr = array
      with r = robot
      for move in moves
      do (setf r (execute r arr move))
      ;; do (print (list r arr))
      finally (return (calculate-gps arr)))))

(defun problem-2 (&key (input *input-part-1-test-1*))
  (destructuring-bind (moves robot array)
      (parse-input input :double t)
    (loop
      with arr = array
      with r = robot
      for move in moves
      do (setf r (execute r arr move))
      ;; do (print (list r arr))
      finally ;; (return (calculate-gps arr :double t))
              (return (2d-array->string arr)))))



(defparameter *input-part-1-test-1*
  "########
#..O.O.#
##@.O..#
#...O..#
#.#.O..#
#...O..#
#......#
########

<^^>>>vv<v>>v<<")

(defparameter *input-part-1-test-2*
  "##########
#..O..O.O#
#......O.#
#.OO..O.O#
#..O@..O.#
#O#..O...#
#O..O..O.#
#.OO.O.OO#
#....O...#
##########

<vv>^<v^>v>^vv^v>v<>v^v<v<^vv<<<^><<><>>v<vvv<>^v^>^<<<><<v<<<v^vv^v>^
vvv<<^>^v^^><<>>><>^<<><^vv^^<>vvv<>><^^v>^>vv<>v<<<<v<^v>^<^^>>>^<v<v
><>vv>v^v^<>><>>>><^^>vv>v<^^^>>v^v^<^^>v^^>v^<^v>v<>>v^v^<v>v^^<^^vv<
<<v<^>>^^^^>>>v^<>vvv^><v<<<>^^^vv^<vvv>^>v<^^^^v<>^>vvvv><>>v^<<^^^^^
^><^><>>><>^^<<^^v>>><^<v>^<vv>>v>>>^v><>^v><<<<v>>v<v<v>vvv>^<><<>^><
^>><>^v<><^vvv<^^<><v<<<<<><^v<<<><<<^^<v<^^^><^>>^<v^><<<^>>^v<v^v<v^
>^>>^v>vv>^<<^v<>><<><<v<<v><>v<^vv<<<>^^v^>^^>>><<^v>>v^v><^^>>^<>vv^
<><^^>^^^<><vvvvv^v<v<<>^v<v>v<<^><<><<><<<^^<<<^<<>><<><^^^>^^<>^>v<>
^^>vv<^v^v<vv>^<><v<^v>^^^>>>^^vvv^>vvv<>>>^<^>>>>>^<<^v>^vvv<>^<><<v>
v^^>>><<^^<>>^v^<v^vv<>v^<<>^<^v^v><^<<<><<^<v><v<>vv>>v><v^<vv<>v^<<^")

(defparameter *input*
  "##################################################
#...O.#O#O..OO.O.#..O....O...#.O....OOO.O.O...#..#
#O.O.OO.##O.....O....#....#.O#O...O.....O...O..#.#
#.O..OOO..OO.O..O..##O..O....OO..O..OO..#..O.....#
#...O...OO............#...OO....O.#O...O....OO..##
#....#O.O....O.OO....OO..#OOO.OO...O.O.........O.#
#.......O.#O...O.#.O#O..OOO.O..#.O.#........#..O.#
#..O.....O...O....#......O.##OOO#...O.#.........O#
#.#OO.O...#OOO#...O...#O.....OOO..O.........##..O#
#O.O.OO.#O....OO.OO.............#..O.OO.....O..O.#
#..OO...OOO..#....OO.OOO..O.......O.#..#..#....O.#
#.O.......O.....O.O.O.O.................#OOOOO.#.#
#.#O....#.O#O....O#....OO...OO.O.....O.....#.O##.#
#.#O.#..O.OOO.......O.OO#...O.O.O.#O.....O..O#...#
#..O#...O.O....O.............OOOO....OO.O..#.....#
#.O#.OO#O.O..O#OOO...#......#.......O...OOO#.OO..#
#...OO.O.O.O#..OO#....O#.OOO.OO#O......#.#.O.OO..#
#...O....O#O..O..O.#..OO....O.O.O......#..OO.#.O.#
#O.O#OO.OO.O.#...............O....O........OO....#
#.....O......O...O.O.O.OOO...O..OO.OOO.OO.OO..#..#
#.##...O....O.......OO..#OOO.....O....O#.........#
#.OO..O.O...#O..OOO..O..O..O......O........#..OOO#
#OOO...OOOO#...OO....OO.....O#...O....O.OO..OO...#
#..O...O...#.O.##OO.......OOO#...OO....O..O..O...#
#..O.#O.#O...#.OO.......@O.....O....#...O....O.O.#
#...OO.OOO...O.O..O.....O.O...O.O.OOO.#.OOO.O#...#
#.....OO.O...O.O#O...........O....OO#...#..O.#OO.#
#.O....O..O..O..#OO#.........OO.#..#....O...OO.OO#
#...O#.OO.O....OO............O.O.O..#.......O...O#
#.....O#.....O.....O...O.O..OOO..OOO...#.....OOO.#
#..O....#.O...O......O..OOO.O...O.O..O..OOOOOO#..#
#O#.O.O..#.....O...O..O...O..OOO.O..OO....O.O..O.#
#.#.O..O.O.....#...O.O...OO.OO..#O.O......O..O.OO#
##..O.O...............#.....OO...O...#O.O.....O..#
#..O.O..#.#..O...O..O..........#.O#O.....O..#..#.#
#..#....O.##...OO..O.....O...OO.O#....#O..O#O...O#
#O.O...O#O.O.....#.O...O...O.......#.#OO....O.O#.#
#.#O...O..O....O...O.............#..O.#.#.#......#
#.#...O..#.#...#OO.....O..OO......O...OO.........#
#....OOOO...O.....O.OOO......O.##..O...O.O.O.O.O.#
#....O.O..#...O.O.....#OO.OO.....#...O#O#......O.#
#...#.O......O..O..#...O##OO.#...#.O.........O..O#
#O.OO..O....OOO...O.O.OO.#........O.OO#O..#.O.#.O#
##..#.....O.#O....O#.........O.O....O..O..O..O.#.#
#..OO...O.....O.O.....O..OO..O.OO..OO.OO.O...OO..#
#..............O#OO......##..#OO#...#.O#.OO..O...#
#OO..O....O#.O..O..O......OOO.....#.O.......OO...#
#.O.#O.#.#.O.........O#..O........O.O.#.OO.......#
#........OOOO....OO..O#.O..O.##OO..O...OOOO.OO...#
##################################################

^<<<^^^vv>^^<^^^v<<^^<<>^>>vv^>^vv<><vvv<vv>><v>v<>^^v^>v^<<>><<<v<<^>>>v>>^^vvv>vvv<v>vv>><v<<<<v^^>>^>vvvv<<>v^>vv<<<v^vv><>^^^<v>^^<vv>v>>>>>>v<><^<>^<^^><<^vv<vv<><^^>v>^^v^v^^^^>^^<v^v>^><^>>v>vvv<^<v>v>^v><^^<<^v>v^>^^v>^<<^^>vv^vv>^>vvv<>v<<>^v>vvv><>^<v>^>>vv>>vv<^>^<>v<^<>>^<^>v>>>vvvv<><<>v<>^><>>v>^<><v>v><v<>vv>>><v>v><v^^>vv^<>v^^^<vvv<^<<vv^<^vv<v<>v<<>^>>^>v>v<v<v><>v>v<><v>^^v<^>^v><>><^v<<<v^<^><^<^vv^^<^<^>^v><^^>^<<<v>><>vvv<v<<vv>>v>^<v^>v<^>v^v>v<^^^v^^vv<^^v>v^>^vv^^^v>>>vv^<^^>><<^^^v^>>>>^^v<vvv>v>^<^><v<<>>>v<><^<^<><>^<^^^><>v^v<><vv>>>v^^^^v^v<>^<<^>>^^vvvv<v^v^<<>v<^<<><v>v^<<^v<<v^v<>^<>>>v>><vvv>^<^^^>^v>v<v^>vvvvv^><v><v>>>>><^>>>vv^vv^<>>>^v><vv<^v>>>>v<v^>>^^<^<<v^<v<^<<>><<^><<vv^v^^<^<><v><^<^><v^^v<<^v><v><><<>><v<<^v^<<^<>vvvv^<^^^<<>^>><<<<><^^^^<^><v><^<^^^<v><v>v<^<^^^^<>>vv^v>^v>>><^<v>v^v^vv<<>^^^vvvv<<vv<>^^vv<<vvv<v^v^<>v<<^^^>><vv>^^<>>v^v^v<^^<v^vvvv^<>^<v^^^v>^^vv^^^^v><vv<<<>^<v^v^>>vvv^>>^v>><v>^>><^<^<<>^>v>>v^^vv>^><^v<vv><<>^><<^><v><
>^<v^^>^<<v^^^v><>><<v>^<^v<^v^^^^^<<>^v^^>^v^^v>v^^<<>>v<><^^<>>>^v<^v<>vv>v><v>><>v^v>vvv<><^vv<^v>><<^v<^>v<^<<>^vv<><v<><<<<^v^^v^><^v^>v<<><^^^^^<>v^>v<>v>>v^>>vv<v><vvv<vvv<v>>v>>^>^^v<^v^>^><^vv<^>^>^><v>>^^<<v>v^><<<<^^<<v>>>^><>^<v>><<^><<><<^<^^^<<>^^vv<>vv><>v^><<v^^v^>v>>>^<^<v>v>^^<^<^v^v^<v<>^v<>><><>v^v^v>vvv<<<^<^v>^<^><>>><<^v>><<<<^^vv^^^<<^>^vv<<^v^vv^v>^><>v^v><<>><>>v^^>v^>><>^vv^^^^>^v>^><^><^vv>>v^<^<>>>v><v>v>><<^>v<<<^>^>^>^<><^^^<^>>>^<vv><v^vv>^<<>^^^><^<<v^^<v>v>v^><vv<v<<vv^^<>><v><vvvv^^<<<v^<>>^>^<^^<^<^v^<v^<>^^<vv>^v<<>^v>><^>>vv<^<vv<><v^<<^><^<vv^>v><^<v<>>^vv^<v<>v<vv^>^<vv>>v^<<>v<><<>v<>>>^v>^<v^<^^<v^^>vv><v^<^vv><<^>>>^>>><><^v^v>^^vv>>^<v<vv>><<v^><<>>v>^^><^>>v><<vvv<<^v^<>v<>><v^>v><^v>v<^^<>^>^><<>>^>>>^<vv^^v>v>^^<v^^<v<>v>v<v^>^^^>>><<>>^v<vv>^>vvv>>v><v<v^^<>vv^<<<v>^<<^v>^><v<>>^^<<^v^>v>>v<>vv<^v>>v^>^<^^^<<^v<^v<^<^v^vv<<>^v><<>^<<>v^>>>>>>^vv>>^<^<^>>v^>>^v<v><^v<>>^^vvvv^<<>v>>><^vv^><^vv><>v<<vvv^^>vv><^^>^^<<>>v>v<>>^<v^<v^^v^<<<>^^
>^^^<v<^v<^^><<<^>v>><v<>vv>><v^v^^>^^<^<<<v<^>v<<^<<<<<^>^v>v>v><vv>^vv><><><^^v^><<<>vvv^<^<><<^^v>vv>>v^^<^v><v><>vvv^><<<>v^>^<>>^<<<^<v>^v><^<^<>vv<<>^^<^^vv^><v^^vvvvv>^^<^<<^v^^<<v>^vv<^<vv<>>v>>^<^>><>><^^>vvv>vv^v^v><><>^v^>>vv>v^v^<^><^>^>^^^^><><^>^^>^>^<<<>>^>^v>v<v<^vv><v^^>>v<^<<<<>v><<v^^<v>>^<^<<>>v>>><>v>>><v><^<<<v^<v<v^^v<^^v^<<>>v>^^><>^^<>>vv<<<<>><^v<><^^<v^>^>>>>^>><>v<v><>^v<<><><<>v^>^v>^<v>><^^v>vvv^v^v^><>^v><v^v<>><<^v><v<^v<^<v^v<v><^^<vv<v>><<><<<^^^^^v^<v^^vv>^>v^v>^v<<^vv^<^^<^>^<>><>v<>^>v<<>>v>>v<<^^^^^<^<v>vv>><^v^vv<<vv^^<^v^<><<<v><><v><<<>v<><<v><^<<v>v^<<^><^<^>vv^^<<^<>v>>^^<^>vv>v<><v>v^<>>^>><^><^<^>v>v>^vv^^<^v^><<>>>^<<>v^>vv>v<>><>v^>>^^<v>^^v^^<<><^^v<^^v^v^<><v<^v>^><>v>^^<<v<v<v^v^v<<^^>>>>^^^v<>^><^><v^<^><>v>^>>^>^><<>><^v>v>v>vv<>^^^v^><v<<^^^^v>>vv<>vvv><><^>^><^^v<v>^>^^vvv^>^><^><<^v^vvv>v<^<vv^>^v^^><v^<^^^>^vv<^>>>v<v>>vv<<<^^<v<<<^vvvvv^v<<<v^<<<><>v<<<^><<^v<>v><vv<^>v>^<^<>^<>^<^^v<<<^v>v>>^v^>>^<v<^^v<v^^vvv>v^<^v<vv^^><><v^<^
>^v^^<vv>v<<>^^<><^><v<vv<<^^>>v^^><><^>vv<^>v<^<^>v^<vv^<>>>v^vv^><>v>>>>>>>^^^v<vv>v<>><<v^<^v^v^vv><<>v<<><><^vv>^v>^<^<<v^>^<>^<v^v^^^^<<^>>^vv^>>^<vv<^>vv^<<>>^<^<vv^>v^^v^>><<><>>^>vv<v>>>^>>^<>>v>v<^^v>^^^v<>>^<vv<<v^^^v><^<<v<^^^<^><^^vv<vv>v><v><><vv<>><<<>^<<<^^>v<<^<vvv>v>>v^>v<v<v><<<v^^v<^v^<^<^><<^vv^><v^>>><v>^>^<>>vv^^>^^v<v>^^<vv<v<vv><<<><vv^<<v>^><v>v<<>^v^><<<^>vv^vv<^^^v><^><v^<^<>^v><v^v^^^^>^^<^v^><v>^^^>><^^^v>v>vv<<^<^v<^<vvvv^vv<vv<^^^^^v<<^<<<v^v^>><>v^>v>v>^<^<^>>>v<<v^>>^vvv<<^^<^^>^v<>^^>^<<>v^v^>>^vvv>><v^>>^v>^>>^v>^^v>^><v^<<vv><>^><^>^>v>^^^><v<v<<>>v<>>^v<>v^>vv>v^>^v<v>>^>><v><<<v>v<^<<>vv>^^^v<<<><v^>vv^<<>v^><>vvvv^^>>><^^v^vv<^>>>><^<^^>><^>v><^^^<>vvvv^<<<v>><v^^<<^^><^^^<<><<<vv<^^<v^<vv^>^^>>v<^^<><><^>^v>>>v^>><v<vv>^>^^><><^v<>>v>^^v^vv>vv><>vv<<^<>v>v>v<^>^^^v^>v^^><^^^v><>v^^<>>>^<v^^>>^<<v<<^^v^<<><>^^>>v>>><v<^>v^>^v<<<>^>^><<<>v^^>>>v^v^v<v^>vvv^<>>v>^^^<>><>>^>^^^^<>^v<>>v^<>>>>v<^>^^v><^^^<v<<v^<^^<^^^^<>^<<vv>^vv^^<><^v^><v^>>^><^<<v>
^^<v<vv><<<>^^^^<<^>><vv>^>v^v<v^v<<>>^vv><>v^>>>><^>v<v<v^<><<<<<v^<<^><v^>v<^^<>^vv<<^^>>>^^vv<^>>>^v><><><^v>^^>>^>v<vv<v^vv<^>^v>vvv>v>>^>><<>v>^v><><><<<>v^>^^^><^>><^vv><>^v^v^>>vv^<>>v<<^>v><<^vv>>>>v><><<<<^<<>v<<v>vv^<<>>^^>^^v^>>^^<v>>v><v<>v><^^<v>>v>v^v^^<^v<vvvvv<^v^>>v^><>><^<v^<<>v^<><<>^<^<^><>v^>^<<<^<^<^vv<^<<v<v^^v<<>^<^^<^<<v>^>><^^v><v>><vv>>^<v^^v<^^vv^><^^>^<<vv><>^vv^^^^>v^^vv^>^^>v><^>vv<>v<^<^<vv^^>^<<>v<v>v<v^v>v^>><>v>^<><^><<<^>^v^<^^>^<>><<<^v>v^>v<^v^<vv<>>v>>>v>^>v>^v><<vv<><^><<><^<>>v<v^^^>vvv<^<<v>^<v^v^<vv<^>>>^^>v^v^^><^v>v^<><v>><vv>v>^^vv^<^>vv<^>>^<<v<><>v<^v>v>^>^>v<^v>^v<<v^^^>>^<^><<<>>v>^v>^v<v<v<vv^v<>^^v>^<<<<^^<^>^<>>^vv>v<^^vv>><^vv<>v>>v<>^>>>>><^^<^<>vv^>^<v><<^>vvvv^>v^v^<^^^v><>v<v^^^v>^><v>>v>vv>^^<^^v>^^<><>>vvvvvv<>vv>>^<^v>^><<^>^>v^v<^vv^<>v><^<<^vv^><v<vv<^>><vvv>>^^^>v<<v^<>vv<v^v<<<^>><v<<>v<^<<^<<>v<^>v^^<^<^^vv^^^^^^vv>><<^^>>>>>>^^>^<>^<vv>><<>><<v>>v^^v<^^^<^<^vv^<v<^<<>>>v<v>v>v<v<>^<v^v>>^^v<<<>^^><^^v<>>v<<<^v><v<vv<v>>
^^>vv^^^>v^vv^^<<v^v<<^^^vv^v<><>>>>^v^v>^^<<<^>>>v^>v>>>v<>v^>^^><>>>^>>>^<>vv<<v>v^^v<v^^>>v^>><<^v<vvv^^v>><<vv^>>>^v^v<>><^<^<v^<<v^^>^v<<<>>^^>^>>v><v^^v>>v>^<>^^v>vv<v>^<^>^v>>^><<^<><vv<>><<>v>>><>^v^^v<^>>v>vv^v<<vv>^v^v^>v^>>><>^^^vvv^^^>>>>^^<^v^<><v>v^^vvv>><<<vv>><v>v><><v^><v^^v<<<^<^^^>v>><<^^^<v>v><<<><<>v^^<<<<^^v<^<<>^<vv<^>^>^<<^<^^>v^v<><vvvv>vv<vvv<>^<<v^^<<<>^><<^v<v^^v<><v<v>v^><v>vv>^vv>><>>>>v>>>><<<><v><^><>>v><<>^>^>^^^v^vv^>^^<^>>>>>><<^<v<v^v<<>>^>><<>v>v^v>^<>>>^^<v<<vv<^<v^<<v<v>v>v<<<<^<v<>v^<<<v>v<vv<^v>v>^>v<v<^><<>v<v^<>v^v^^<>v>v^>v^^^<>>vv>>>>v<^^>^>^^<^^^>v<<v^><v<^vvv^v>^v>v<>v^v<v>>vv<^^vvv^vv^<v^>^>^>v>vv^>v<v>^<v>^<>v<<<>>v><>^^v><^v^v<v><<>^><<^<vv>vv>><<>><<><^<>^<^<v<<v>>^v<^^<<<>^^<vv<<v^<^v^>>^^v>^>v<>v><<<>v>^v>^vv^^^><<>v^v>>^v^v<v^<<<^<<^><><v>^<<^>v<><>><<v^<<>><<>v>vvv^^>^<<<><>>><><>>^<<<^v^>>>>^><v>><v^^^v><<^vv><>^v>^^>^^vv^v>>vv<>>^><v<v^<<<>>^>^v>v<vvv<>v>^<^<v>v^>><v^<<<v<^v<^vvv>v<^><<<<<<<<v^>><^>>v><vvvv><v^<<>^>^vvv>>>v<v<<v<
v>>>>v<^v>^>vv>>>><^^>><>v>><^^^><>v^^<>><>>^<>^^^><v<><^><<^vvvvv>>^v>^v<<v^><v>^<<<<^<>^<v^>>^^^>v^<^>^<v><<<>>v<v^^v<<>>v^<>>^v<>>^>^<>>vv><<<<>>v<v><<><>>vv<>^v^vv><^>^^^<^><><<v<><<><vv^^><<v^<^^><v^>>>^<^v^^>v^<v<<v^v<vv<>^^^><<v<<>>^>><^^v>v<><><v<v<<>^<><<v^^<^<vvv><v>><><^>^>^v<vvvv>>^<><^v><^<>><v<>v<<>v>^><v^<^v<v^vvvv^>v<>^<<>vvv><<>^^<^>^^<<<^^>^v<vv<v^^<v<^v>>v^>^<^<v^<<<>>^^^^v>>>><v>vvvv>><^<^><>>>vv<>v^<^^<v<v><>vv>v>v^v>v>>>v<^vv^^<>v>v^v<>^vv<<v>>^>^v^vv^<v^vv>v^vv^>v>^^^>vv>>><>v>>^^<^^>^>vv<^>vv>^>^v>>^v<>v>v>>^>^<<^v<<^><^v<v^^<^vv<<<><^v^>>vvv^^^>>>>^>vv<<v>>>>v<<^^<><vv<v<<v>v>^<><^^v<<v<^v<v<^<<><v^v<^<<v^<<v<<^<v>^<>><<>^>^^>>v<v<<>^v^^v<vv<<<>><v<>^<vv>v>v<^v<^^^v<>^>><^>^<^><vv<<^>vv<^^^vv><<^v<<vv^v^v^v^>v>v>^vv<>>^<^^v^^><<<><v^^^<v<<>v^<^>v<>^^vv<<>vvvv^^^<>>v<<<<v<<<v^>vv>^^<^>>v<>>>><^<><<v>^>^<v>><<^^>v<>vvv>v>>^>v>^>>^><<^>^<<^v>><<^<<^<<v>^<>v<<<<^><><^^^<><^v<<v<<^v<>><^<vv><vv>^^v^v>v^<^^>v^>>^>^>^^v^v^^><<v<<>vv^vvvv^v^<v>>^vv^^v<<v<<<v>v>^vvv><>>
^^^<v^>v>^vv>>^v>>vv<>^^<^v>^><v>vv^v<^^^vv>>^vv><<^<><^<^^>vv>v>^>v^<>v^v^>^v<<vv>^v<v^<vv<<^<>>>^^^^>v>vv>^>^>^^^^^>>v<<>>^>>vvvvv>vv<vv>^>><^v^>^vv^<v^^^^v<v<<<<vv^v><^><<<^^^^^<^v>vv^^^><<^><>^<^v>^>>v<>v<^>^v<<^<^v^vv<v^v<vvv<^v^<^>^^^v^<v<<^^v><>><^^<^v<>>^<v>^v^<v><<<^v^<>^vv><v^>^vv^v^^^<v>><<^<>vv><><<>^>v<v<<v>v<>^<v<vv^<^^v>^v>>^^<<v^<v<v>v^>^^><v^v^^v><^^v<><><^>v>v^>>v>>^>^<>><^^<<>>^v><^<^>^^>^<<>><<^><>>^^v^^^v^vvvv^^>>v>><>^<vv<^v^^^>>v<v<>><><vv<^^<^<v<<<<<>v><vv>vv>v><>>^v><<^^<v>v^>^^^<^>v<>v<>>>>^vv<>v^v^^^>^<^>^<<><v^<<><<vv^^v<<<^<^vvv>>><^>vv>v<v>>v>v>v^v<>v>v^^v>^>><^vv<<^><<>^vv>v<>^>>vv>v^>>^>^><^vv<<^<^v>><^<^<v<>^v><v<^^v>v<v<^<^<vvv>v^^v<>v>>^^>^>v<>>v^^<><v^^v^^vv<><<><>vvv<^>^vv^<v><v<<<^^vvv^<^>vv^^^<^<v>^^v<^^>v^vvv^<vv^v>v^<<<v^<<<<<v<>>^<v^>v>^<v>^>^<^v>^<^^<<v<>v>v^v<^<<><>vv^vv<v>>><^v>v^<>><v>^v>v<<^>^v<>v>vv>>^vv^v^<v<>>>v^vvv^^>v><^v<^^<<v^^v<^v^^v<^><<<<><>^>^vv>v^>>^<>vv>><^v<>><<<v^vvv^<^>v<<^vv>v<<>^>^<v>>^^^^><><>v<^v<^>^<v<<>vv<>><>^>^<>^<^
<^>>>v<^>v>^><v<>^>>v>v><^v<<<v^<^<v>^>>^<^^^^<v^vvv>^^<^^vv<^^>^<^^v<<<v^v>v>v<^><<<>vvv>v<v>><>^^vv<^<<<v>>v>^^^^>><v^<<v<<<><><v^<v^<>v^v^><v><v<<v<v>v^<v^<><<v>^vv^v^<>^<<<v<^^<vv>v^^<<v>v<>>>^<^><>>v<>^>^v^vvvvvvv<v<<<^><v><v<><v<v>^<v><><>>^^vv<>^v^<^><<^<^vv>>>^^>v<><><^v><>^<vv>>^v<vv>v^^v^>v^<<>><^<^^<>vv<^<<<>vvvvv>>^><v><><^>^>>^^<v<v><>vv<vvv<<^>^vv<^>v<<vv<<>^^><>><<^^<>^v<<^<v^>^v<>vvv<^>^^>>^v^<^>^>vv<v>v^v>v<>vv^v^^<^<v>>v<v><^vv>v<<><^v^v>><^^<v<^^<>^<^^^<^>><^v^>vv>>^>^>>vv>>v<^<^<<>^^>^v^v^vv>v>^><<><<^v>^v>v<<>^><>v>^<^>^<>><<>vv<^^^vv><^^v<^^<v>>^v><vv<>^^v<v<<><v<>vv<^<>>>vv^>><v>>>>^<>v><>^>><v>>v^<<^><<^^>vvv^^^>v<vv>v<^>>vv<v<>>v^^>v>>><<v^>>^vv><^^<>v>v>^<^^^v^<^v^>><v><v<<>^<<<v>>><^^>>v>v^^v^vvv>>vv>>v^v>v<>vv>v<v<^vv<^^>^^<^vvv<>>^v<vv>^<><^v^^v^><<vv>v^><v>^>^<<v<^<>^>v<v>v<<v>>>v<vvv^><^v>>><<><v>v^^><^><<v>vv^^<<<^>>^<<^v><v^<>><><^v<<v<>vv><>^><^v<vv^><^><<<^vv<v<>>^<<<<v>>^^^<v^>>><>><vvv^^vvv<>><>>><^^>>^^<^v<v^<<<<>><vv><<vv>v>>>^^v<>v^v<<v<^vv><^v<>
^>v>^^>>^<vvvvv>vvv<^<v^<<v<^^<>^v<<^>v^>v<v>>v><^^v<><v^v^v^<>>vv<<^<v><^^<^><>><^^>v^^v>^<>vv^v^v<^v<<<vv^>>>>^^vvv^>>vvvv<<><<>>^v<^>vv<>>>^<v^vvvv<>>^>vv<>v<^^v^>>v<v^<>v<><<>v^>^v^^>^<^v^<>v^<^<>^<>^^>v>v<>v<<>>^v>>><vv>vv>^>v><v<^v<<vvvv<v<v>><<^>>vv^^v<<<^v^<v<v<vvv<>^vv><^>v<vv<^^^><vvvv<<>>>>^vv^v>^<<<>^>^<<v^^>^vv>v^><vv>>v<^^v^v^<<<^><<<^<^>><>vv><^^>v>>^<v^>v<v><^v^>>>v>^<^<^>>v<v^^>v^<>>^^v<<><<v<v^^^v^<^<v^^<<>v><^^>vvv^><vv^^v^<<>v>><^v^<vv>vv^^v>v<^<^>^vv^v<<^^<><>><>^vv<>><^^v^<<^<^>>v>v^v>v><^^<<^><<<>>^^<><v<^v><><v<>^<<v<<>^^v>^<><><><>>vv^<vv<v<vvv<<^<v^v<v^^<>^vv<^>>v^^><^<^<<v>>>><<<>^<v<v<<>^v><>^>v>>vv^<<<<vv^^^v<<<><^<<v<>vvv<^>>vvv<<><>^<v<v^^<^^v><<>>>^<vv<v<<<>>>v^<<<v>><>><<vv>>v^>v<>><>vv^^<v>v<>>^><^v>>^^^>>><vv<v>^v<><^>>^<<>v<^^>><<<^^<><><>^vvvv<<<>vv>>v<>>v<vv<^><><><<<<><<^^v>>>><<^^v><vv>^v><<^<><^vv>>>><<><<<vv><^<>v^>^<<^v>^<<<^<<>>>^>>>^v^>>v^vv^><^<>v^<^>^<^^vv>^<v>^>>^>>v<^v>^>><v<<<v>v><><<>v<>>vv>vvvv<v^<^v><^v><^vv^><>><v>v^^v^^vvvv>v<^>v>>
<<^><<>>v^<><>vv<<^<><<v<<vvv^v<<v>>><>^^<v<^<^>^>><<>^v<>>^><<v><^<>>v>v>^<^v<<^>^vvv>>>vv>vv>vvv^v^^vv>^^^<<^>v><^>>v<<^v<v^<><vvvv><v>vvv<^vvv<<<<>v^><^v>><v^>^^v><v>vv^>v>v^v>v^^^<^>>>vv>vv<vvv><>^><v<><v<><<^<<<<><<v^>>>v><^vv>v>>v<^^<>v><>^><>v<vvv<<<^v>v><v^^^^v^>>v><v^<vv<>^<^<^>>>^vv^<v>v<<^><><>>v<v<><v<<^^v<^<<<vv<<>>v>>^<<>>v><<<>>>v^^<>^>>>^<^v>vv^><<^><^>>vv^<<>v^<^v>^^^^<<><^>^><^^^^<^vv<v^^v<<v^vvvv>vvv^vv<v>v<>^vvvv>v^v><>>>^<^<><<<<v<<>v>^vvv^><^vv^v<>v^v>>>>v^<>vv><>v^v<<v>>><v>v>vv^^><><^v^>>vvv^^>v^v<<>>>v<^v<^^v<<vv^><vv>^<v>v^<v>><>^><vvv^vv>>v>v<v<>vv^v<>>^>v><^<^>v>^>^^^v<<>^^^v><>>^<^<v>>v<<>v^^v<<^v^<<v<>vv>><^vv>^<v^v^<<^><<^^<><>^<^<<v<v>vv<^<vv^<><v^><^<v>><><^v><vv<<^v^^>>v>^^>>v>>vv>^>vv^>v^^<>>>>^<>>>v^^^^>vv><^<^^^<><v>^^v>><v^^<^>>>v^><><^<^>^<v^>v^vv<v<^^v<<v^>v^>>^>vv^^v<>><^>>^^<^v^<v<^v>><v^>v<>^vvv^v^^^v>>>vv>>>><>>^><v^><<>^^><><>v>^v<^vv<>^vv<<vvv<<v<>>v>>^v><<<><^^><<v^vv<>^><>v^<<v>vvvv^<<vv<v<v>^>>>^<^<>>v>><<><<^><<>^<^>v<>>>vv^<vvvv<<>><<>
<vvv<v>^<<>>v^v^^^<<vv<<<v^>>>^>^><>v>>^^>vv>^<><<^v^<<<v<v^>v^v>^v>>>v<^>^^>v><>^<<^v>^>>^^<>^<v^<^vv><<>v><^vv>>^v>>^^v<><^><^^v>v^v>>v><<<^v<^><^<^<<^<<>^><^v>>>v^<>>v>^^^<v<>v<<<><^^^v<v>v>^^>^><>><<^><>vv>^^>><<<<^<<v^>v<<v<>>>>>v>vvvv<>^>v^>v>>^<<^^v>><>v>^>>v^<vv<<<v>v^^<>>vv^v><^>^vv<>^<>v>>^v>v>v>v><^v<^^><v<<^>>>vv^^>vvv>vv>vv<^v<<v><><^>v<^v^vv<<>><v^^^vvv<v>v>^><<v>v^v>>^^>^^>>>^v<v^>>^v><^>^vv>^v^>v><>v<v>^^^^<^v>^>^^^>v>v><^><^v^^^>v>v<>v<v>vv<<^vv^^v<><vv>><^>>>^<>vvv<^v>v<v<<<^vv^<^<<<<><<v^<v<>^v^>v>v^^v^>>^v><^^v><vv^<v<^<^v^vvv><^<<>^>vv^^v<^^v<vv<^<<v<^^^<^v^v><^>>^^>v<^^<^<^^<^>v^vv>>v>vv^<^v><^^><<<<v^>v^v<v<<^^v<^^v<v^vv<>v^>vv<v<^><^v<v<v><^vv<<vv<<^v>vv>><^v^<<><^>>>v<^v<vv^^<<<>><>v<^^^<v<^^^^<<v>v^^vv>>^^>^<^<<<vv^<<>^^<><^^<><^^><v<<v<><^v<>>^^>>>v^^^<>^<<<<><^^<vv>^v^^>vv^<>^^^<<<<^^><><>v^^>>>^>v>vv^<v^<><v^<<>><<v^<<v>>^>v>>vvv><<v<>^v^vvv<<^<><<<<v^v>v<<^^>v<vv<^^^vv^<^vv>^<>^<^v^<<v^>^vv<>>vv^>v^<>><><><><^v^>v<<vvv>>^v>v><<v<><vv^>>>^^><<<^^^^v<>v^<>>>
^vv>>>><v^v<><v>^<<vv>^<^>v>^<^v^v<^v>><v^>><<><>^<v<v<>^<v><v<><<<v><^>>^^>v<<v<<v^vv^>^^>>>^<<v^v>v^vv>vv>>vv<^^<><<^^^<<v>>v^>>^>><v<v^v<^>>v<^<vv>v^vv^<<<v<^<<<><v>^^v>^v^>>vv^v<>v^v<<<^^^>^v^vv^^>>>^>v<><^><<v<>>^v<^v<<^<<><>>^vv>^^>>>v>v<<vvv^v<>vv>^>>v<<>^vv<<<>vv><>>^<^<>^^^v^^v^v^<<^>v<^<<^><>v^<<<v<><<<vv>^>>>v^v<><v>^v>v>v^^vv^vv^>^^^>^v^<^v>>><^vvv<^>^<^vv><v<<>>^^^>v>v<>v^v<v^^<^^vv>>v^<^v^<>vv<<v<>>vv>^><<>^^>>^>^v<^>^<>><>v>v<^^^<<^<>><^^v>>^>v<v<^>^^vv>>^<>>><<v>^^^<^>^^^>v^>>^^><>v^^v^^^^><<><^^<v^>>^>vv<^>vv>><>v<^>>^<^v><v^<<vv>^<vvv^<<^^v^>^v<vv>^><<<<>v>^>>vv>^>v^>^v>^<v^>>>v^^<^<v<<^<v<><v<vv^v>^^vvvv^v>^v<v>^>^^^vvvv^>^>v^>>vv>^<v^<^v><<v^>>^>^>^>^^^v><v><<>v>^>^^v>>>^>><>>^<^v<vvv^^<>>vv^^v^^v<<<v>^<^>vv>>v<^<^vv>>^^>v<>v><v^>v><<>^v>^v<<^<<>v^><v^>^^^><><vvv^<^^^^>v^v^<^^v><^>vv^>>>><<^<><v>^><><<>v^v^<<<^^<<<v^^>^^v>><>><v^>^<v>^^<^^<v>v^<>>^><^<^>v^vv<^<>^<<v><<<>>^>v^v>>^^v>v><v^<^^^v>>v<^<^v>^<>v>v<<>>>v<<<^>v^^<<^v<<v><^vv^>>^>>^<<v<v>^<^<^>^^^v><^>>v<vv<<
^<v^<<^<vv^^v^v>><v>>v<>v>^><>^v>>v<>v<v^<<><>^v<<><^>vv<><^>>v><vvv<><^^<^v<<^^^<^<<>><^>^v><^<<>^^>v>vv^>^vv>><v<<^<<<<^<v^vvvvv><^^<^^>^^><>>^><>vv<^>^<<>v<^^v>><<<^v<^^>>^<^>v<vv^><^vv<>^^>v<>^v><<^<><>^vvv<^<v>^^>^^v<^><<v^>v<<<^^v<v<v>v<^>>v^v>^^^<^^<v>>><<<<^v<>vv<v<v^v<v>^^v<^>v>v^>v<^>^^<><v<v<^^v^^>>^^><>^^v<v^^>^^v>^>v^v>>^v^v^>v<^><>>>^<vv^^<^>^<v^>^<><<vv><^^^<>v^v<v>^^v>^v><^>>vv><<v<<<>v<vv<<^>><>>^<^^>^<<vv^^><<v>><>><>v^^^>^<^v<^<^v^v^v>^<^^>^^v<^><<<v>>>^vv>>v>v<v<><<vv<vv<^v^<>^<>vv^^^v^v^v^<>>>v<vv>>>^>><^<<^>vvv<^>>>>>>>v^>>^^>>^v>^>^>v^>^^^^<^>>v^>v^<v><v^^<^^v>><><<^^^<v^<v>v<^<><<>^<<v<^<v<<<>v><>vv^<v>v>>v>>^>^<>>^>^><^^v^v^^<^>^^<v>v^<^<<>^<>><<v<v><^^>v><^>^v<^>v^<v<><<>><><<^^v>>v>^<^v<v^>v>><^^^^v>^<v>>>^>v^^<v>><vvv<<^^<vvvv<^v^v>^v^><v>><<^^^<<v><^^<>v><<<v<>v^^<v<^^<vv^^>><>v^v<^^>v>>>v<^<><^><<<vvv><><v^v^<>>v<<v<<v^<^><>^v^vv<>v<^<<^<^>v><^<v^^^<^^v^<^<v^^^^vv^^^<><^><vvv>^>>v^<v^^><v^^v^<<<<<<<v<^^v>vv^^^<v<>vv^^v>>>vv<<vv>vv>^v>^><v^^^>>v>><>^v^<><>>
v^v>^<>><<<<>>>>v<v^^v^<^v><<>^>><>^<v>v<>vvv^>><vv>^v<<<>vv>^<v^^<^^<><>v^<>v^>><>v<^><<>^<v<v<^<<v<<<^v<<v<>v<<^^<v^v><^vv^^v<><^<>v<<<<^>><><v<<>^^^<>>^^^<v>>v^<<^>^<vvv<^<v<><v^<<<<^><v<v<v<<v<<v^<v>vv>^^v><>v><>><<<v^^vv<><^<>vv>^^v>^>v<vvv<v^v^^<^v^v^<^vvv>>^v><v<<<>^><<<^^<^>v>vv>v>vvv><<^<<vv<>v>^<v<><<<>>^vv>^v<v>^<>>>^<vv^v>><v<<><^>^^>v>>>^v<>^><><^v^^<^<>^<v^v<v<<<><^>vv^v^><v<^<<<^>vv^><<^^<^>><v^<>>v<><<<><v^^v>>^v^v<v^^>>^^>>>>v><<>^v^^>^>v^^<>>>^^<v^<v><>>>v^<^>^v<^v<^>^><<>vv<v^>^>><vv<v<vvv>^v<>^>^^v^>^<^^v>v<v>>^<<>><<<<^vvv^v^^>vv><<^v^^<>>^<<<^<v><<<<>>><^^<>v^v^vv^<<<<<^>><><^^<<v^v^^>^vv><>^><<>^vv<v<<^^>>v^v><>>>v<v<^v^^>><v<^v^^^vvv<>v><<v^<<vv<<^>>v<^v<vv^v^>^<<<>v^>>>>^>^><<><vv^^v><^^^v^^^<<><<<^^>^>^v>><<><^<>vvv>v^>^^><^>v>><^v^vv^>>^^>>v>v<<>^^<<<v<>>^vv>^v^>>v<<>><<<>^>>^>^vv<>^^^vv<<<vvv^<vv^^<<v^^^^<^^v^v>vv>v<v^^vv^<v<>vv>>>^<^^>>^^<><v<v><vv^vv<>^vv<^vvv^>vvv<v<v^v>>><v><<vv^<^vv<^^vv<^>>^>>><^>v^vv^v<^^^>>><vvv>v>vvv>v^v<vv^<v^vv^^<>v^>v^^^^^<<v<><>
v^<>^v>^>v<^>^<^<v^^^vv^<^<<<<<<^^^<v^<>>>vv^<>>vvvvv<>vv>vv<v<><^<<^^>^vv<<v><v^^^<<v><<^^vv<^^>>><<<>^><<^^<>vv^>^>^vvv^v><vv^v>^^<v^^^^<>^<v<>^<^>v<>>>^>^^v<<>><v><><vv>v<>>v^vv<>vv^^v<>^v^>^^^^^^<>><v>>^<^<v><^vv^<>>>>^^><v<^v<^^^>v<<vv><><><<<vv^<<^<>>>^><vv>vv^<>>v^<^vv^v^^^><v^vv>><^>^<^>>>>v>vvv^^^>vvv^>>>v<<<>^^<<<^<^<v^>><^<<>vv>^v><^^^v<<>>>^><vvv<>>^v^<^<^^><>^^^<^^<>^^vv<^v><^>>v^>^>v^<vv>>>>vv><^^<^vv<^<^^v>>v^^<v>>>^v<v^>^^>^v>>v<>^>^<^<^^^^<^>>^>v<v>^^><>>^<v^vv><^v<>><<>^<<><<v>v>^^<v>>>>v^><>^^<>>vv<^>^v>>v><<v>^v><^>v<<v^>v<<<<>^v<^<<>^><v^<v<^>^v^<^^^><<^<vvv>v>><<v>v>v><^v<^<^>^>^><<<>^>^>^<^v>v^^><<>^vvv^<<vv^<^<v<>v<vvv>^<><>>><<<>v<^>>>v><>><vv<v>^v^v><<<>vvv>^^<^^<v>^>>v<^><^v<>v^v>^^<<<^>v>^v<>v^^<^<>><<v<v>v<<v^>v^<^^<<<<v^v><>v>vv^^^>^vv>>>>v>vv^<v^><<^<^>>v^^v<<>v><^v>^v<<><><v<^>v^v^vv^<^v<<<^>><v^>^>><v<>>^^vv><<<^<<v<^>^>^<>^>v<^>v<^<^^<>v<<v><v>^^><<<><><<<><^>vv<^^>>^<<v^<^<^>^^v>v<^^v><v><^^v>>^>>vv^^v>^>>>v<<v>>^<^v^^><v<><v<>>v>v^v>v<^^>v^><v<<v><>^
<>>>^<^<<v<>^<v^^^^vv^<>>^v<v^vv^>>^vv>^<v>^vvvvv>^>^<<vv>>vvvv^><^<><<<v^>v<>^>^>v<vv<<v>v^vv^>vv^v>>^vvv<>^<<v^<v>>^<v^<^v>v^><^^^>v^<<^^<<vvv>v<<^>v^v>^^vv<^<<<vvv><>>v^<^^><v<^v<>^>v>v<<<^<^^^>^>vv<<<><^v<>^<v^<vv^^v>v^^v>>^<vv<>^>^>>^^<v>v^<<>^>>v^v<>><<vv^><<>^<^>^<v>^>>vvv^<vv^^^><vvv<v^v^<>>^^v>>^^<<<><>v^v><<>>^vvvv<vv<v^>>>v>v><<>>^v^^>v<<^v><<^v<^vv>v^<<<^v<><^>^>v^><<<v<^<<<^><<v>><^^v>><<>v<v<^<v>^^<<v^v<>>>>v>v^>^^^v<v<<v><^^^^^^<>vv><v<^<v>>^<v<<<v<v^<^><>>v>v<^^^vv<^v^<v<><>>>^><^<<<vv^>><^>>v<>v<>^<>v^<^><<><^<><<v^<>v>^<>^><v^><<^>^<<v><<<>><>v><<>v<^>v<v<<^^<<<^<>>>^>>^>v^>^<>>><<><^>^^>^vv<^><^<^<<>vv<<<^v<^^<<^<v><<<^<<^vv>v^v>^v<^>^vvv><vvvv>v<>>^^vvvvv^^v<v<<><><<>^>>>vv<^^v>^<vv^<>v^v<>>>>>>^>>v<^<>><<<^v>>v^<vv><>><<^<^^^>v<v^><>v^>>vv><^vv>vv>v^^><<>vv>v>>^>v<v^v>>^^v<^>><>^vvv>^>>^<v<v^^v^^><>>>^<>v^<><^><v^v<^^>>^<>><v><v^<><^^^v>^^^>^><<v^vv>>v>v^vv<v^v>>><<>^^v><<v<v<vv>><^><vv<>v>^<<^>^vvv^>>>>vv<<v<<>v^^>>^vvvv>v>^^^<<<^v<^>>v><^v^v^v><<<^^<^<^^v<^>><^v^
^<v^^v^<><>^<^^^^v<vvvv<>>v^v<v<<>>^^<<v>v<<v<v>>><^>v^^v>>v^^v^v^>>><<^<>v^v>^^^v^^>^>><^>>v^><v^v><^>>>vvv><v>v<><^<v<<>^<<><^<^><^^<<^<v<>^><^><^><<>v>><>v^>vvvv><<^><v>^^<v>><v><>^v<^^<>^v>v^>^<^v>^^>^>^^v>^>>v<v>><^^>>v><<<^v^>>^vvv<^v>vv<v^<v^vv^<<^^v^^v^^>>>^<>v>^<>v^>^vv>^<^>>vv><vv><vv<<^<>v^>^v^^<><<<v<<<><<>v^v^v<v<>>><^<v^<^>v<<^><>>vvv<^>>vv>v^<^^<^^<>>^<<^><^<^v>v^v<<>v^^^^<>v>>^v^<<^<v^v>^><>>><>><v<<^<>v^<^^^>^^v^^<<>^v<<><>^v>>^v<<^>^v^v<v<^^^v>><v<^><v^v<>v<<^<vv^<><vv><>>^>>^>>>^^^v^v>vvvvv>>^>>v^>v<>v><><><>v>v^>v>vv^^<^>^><^<v^^v><>v<<<^v>>^>vv>v<v^<^v<^v<><vv<^^^<<v>v<v^v^>>v<^v^^^v<v>^<^^><v>v^<<<>^<v>>^<vvv^v^^><v^>>>vv>>^<^>vv><v^^><<>v^v^^>v^^>^v<<vv><^><^^>^^<^<<>>^>v<vv^><^vv^vv^^vv>^>^><>><<^><<^<><^^<<^<><v>v^^^^><vv>^vvv<<v<>^^><<^vv<^>^<^<<<v<^vv<>>v<vv^>^^<^<>^>^><^>>^<^>>v<>v^^vv<<vv^>v<><>><^>^><<<>>^v<>>v^^^>v^^<^>^^v>><<>v^<vv<>^^^<>^^<>>>v^>^vv<>vv><vvv^><v>><^<v>>>v<<v>^><<v<>v><vv<v^vv<^>><>^v^^^>>>>^^v>v>^>>^v><v>^<<<v^>v<>v<v<v^v^>><^>>^>>v^^>v
v<<>v<<v><<>vv^v><<^<v><^^<>>>><vv>>v<vv^v>v^vv<^^><^v^^>^vv>v>^<><<^<>>v^>>>^^>^^<v><v^>><^><<^v>v><v<v^>^>^^>v>><>^<<<<v^>>v^v>vv><v<v>^^>v><^>v^vv<v^>><<^><^^v><^<<>v^^vv<<>>^^<^vv^<<^>>^v^><v^^>>^^vv^>v<v>><vv<v<<<v<>><^>>^<<^<>^>>>v>v^v>v>^^>vv^<v>>><v^<><<v^>v^^<>><<v^^v>v^vv>>>><v>v<<<<^>^^^v>vv>v>v<v>^^<v^^^^<>^<<v^>^<>^<>v<vv<>v^v>v>v>^v<>^v<<^><^v>v^v<v>>>>vv>v^>v<<^vv^<>^<^v^vvv>>v><<^>v>v>vv>^<^>>^<^v><v<<^<v<>^v<>^^>><>^>v><<^^v^v^v<<<<v><v>>>>>^^<>>v<>^>^<v>>>v^^v^>>v>^<<<<<><<vv>vv>>>><^>>vv^^^<^<><^>^<vv>><<^^^>^<v<><v<^>v<^<^>vv^vv<^<v<^<>^v^>>>v>>v^<<>^v<^^^>^v<v>>><<>vv<<>>>>v><<><v^<<^<><^^vvv<<<<^^>^<>><>^v^><<><^^<<^<>^^>v^<<>>^v^^>><<^vvv<^>><>^^<<>^<^>>>^^<>^<<<<>><v<v^<^>^<v<^>>>^v^v^^v<><<<v>>v^^vv>v>v<>>v>><v<>>>^v><v^>^v^<<><>^^<>>>vv>^<>^^vv<<^v<v<^>>><<><v^vv^vv<>^>^>>>v>v><<v^>^>><v><<^^><^>^<vv><<v<>v^<>v>^^<<>>v>^^^^v>>><v>^>v<^^^<<v><vv<v>vvv<>vv>vv^><^<<v<>>^v<<^^v^>v<>>>^^vvv^<^<>^>>^<>^<<><^>>v>>>v<<><<v>v>^^^>>v<<>>>vv>>^^>><><>>^<vv>v^>>>>v>>vvv<>
<<><><^^>v>><<^^vvv>^<>>><v>^v>^^^v^<v>>v>>^<^^<<<<v<>>vvv>^^>>vv><><>^>>><><^<^v^vv>>v<v<<^v>>>v^>v<><^^v>>^v^v<>><><vv>>v<<>vv^^^>v^<<v<<^v^^v^v<<^>>^vv^^v><><<<<^>>vv^^<v<<<><<<^^^v^vv^<<><v^^v^v^^>^v<<>^v>^>^<^^<<>>^v^>v<<>^>v>><<>vv>>^^v><^<^<>>^^>^^^<v<^>><^^>v<^<>v^^<>>v>^v<<v<<^>^>v><<>>^<>>v<<><>^vv<vv<><v<^v>vv<>>vvv^<<>v<>>>v^^^^^^<^^>v>^<^^>vv>vv<v<^v^>^^<v^^>^>v^v>^^<vvv>v^v^^v^>v^<>^<v>v>vv<<^v^<^^>>v^^v><><^><<^vv^v^>>^>>>vv^<^^v<>>^^^v<<v^^><v<v^vv<v>^><<>v<vvv><>vv^>vvvv<v<v>>>^v^<<^v>^^^>v<v^>>vvvv><>^^vv^^v>^>vv^vv^<v^<^^vv^^^><<>vv^v>^vv<v>^v<<^<^^>>vvv>v><^<>><vv^<<>vv^v^<^>^<<vv^<<^v><^<<v>^v><vv^<^^>v>vvv<><^v<vvv<>><^^<^>^v<^><<^v<^^^<>^>v^^>^^vv><^<>>v^v>v^>v<<^<>>vv>^v><^v^<^<v^vv<^^>v>>^<vv<<vvv^><vv<v>>v<^>>v^<^v<v<<v^>><vv><>v^v<<^v<v<>^><^^v^<^^>>>v<^<v<<v<>><^<^^vv<<v>><<<v<<>^vv^<>><>^^<v><>^^v<v>vv>^<>^<<>^^v<^^<<^v<<^^><^v<v>vvvvv>^v<^^>>>>^vvv<v>^><v^<><>^<<<^^^<<>vvv>><^^<<^^v^>v^<^v<>v><v^^^v>v>>>vv>^>>v<v>v><><^v^>v<>^<^^v>^<>>^<v>^>^^v>v^v<^^>><<>")
